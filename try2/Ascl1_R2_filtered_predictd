# R script for Peak Model
#  -- generated by MACS
p <- c(0.20259638290174536,0.2359437573788865,0.2698329651193195,0.3027698598515426,0.33603513837970017,0.33459845927248705,0.335279855649051,0.33432754264084114,0.33453278251330015,0.33449173453880837,0.3341305123632805,0.3349514718531166,0.3337282422132608,0.3336461462642772,0.33395811087041494,0.3335804695050903,0.3321766287774706,0.33408125479389034,0.33432754264084114,0.33261173730708377,0.33151165159070345,0.3300421341038969,0.33091235116312306,0.3301078108630837,0.329089821095687,0.3296152351691821,0.3290159347416018,0.3277106091527624,0.32693069763741817,0.3269389072323165,0.32702921277619845,0.327086679940487,0.3267500865496542,0.32711951832008046,0.3281128793027821,0.32780912429154274,0.3285479878323952,0.3276449323935755,0.3264381219435165,0.32728371021804764,0.32609331895778537,0.3255350665046968,0.32473873579955587,0.3232692183127493,0.3204122792881198,0.3192629360023493,0.3167918479379427,0.31759638823798203,0.32175044325655255,0.3260440613883952,0.3364045701501264,0.3730522017764086,0.4371116707683171,0.5095941841259437,0.5808945158182064,0.6538203473003446,0.7380015333881351,0.8197690985758077,0.8968900330510081,0.972861624240438,1.0410094714917302,1.0826403272213172,1.0983042342873894,1.1080161850521502,1.1164063910382749,1.1219314484048717,1.1177938125760978,1.1112753942267994,1.1073429982704845,1.1033613447447796,1.1040345315264453,1.1052413419765044,1.1031561048723206,1.100890256680373,1.1004961961252517,1.0994946255476519,1.0976146283159272,1.0977377722394026,1.0976638858853174,1.0959973381209502,1.092713500161606,1.0868354302143797,1.0819753500345501,1.0794221660211598,1.075374835736268,1.0710565888197303,1.0672144984072975,1.0624611429611468,1.0567636841016843,1.0527081442218942,1.0458120845072711,1.0421752339672974,1.040073577673317,1.032512540771927,1.0286129831952056,1.0232603273214744,1.0182524744334742,1.0145909951088055,1.0081710918982874,1.0001585272774873,0.990249546235166,0.9807264161530675,0.9428637644818281,0.8802902321665228,0.8157956546450011,0.7515309457806335,0.6832106970364759,0.6108677467921213,0.5387628747998193,0.46660053564322873,0.4015394960737202,0.33382675735204115,0.294379653865418,0.28210630949236876,0.27012851053566045,0.26063000923825713,0.25599158812068334,0.2545466994185719,0.2562214567778374,0.257781279808526,0.2565416309788735,0.25672224206663746,0.2569274819390965,0.25721481776053906,0.25774844142893255,0.2576252975054571,0.2561721992084473,0.2557535098686309,0.25386530304200794,0.2533809369430046,0.2533480985634112,0.2544728130644866,0.25347945208178496,0.25296224760318825,0.2512382326745325,0.25141884376229645,0.25160766444495875,0.25128749024392266,0.2511889751051423,0.2514270533571948,0.25191141945619805,0.25102478320717514,0.25045832115918826,0.2496702000489456,0.25063072265205383,0.2496291520744538,0.2493992834172997,0.24867683906624397,0.25070460900613906,0.2502284525020341,0.25153377809087346,0.2508770104990046,0.2526092350225587,0.25354512884097186,0.25406233331956857,0.25496538875838826,0.2563363911064145,0.25659909814316206,0.2560654744747686,0.25772381264423744,0.2573872192534047,0.2581507115789522,0.25715735059625056,0.2580275676554768,0.2575842495309653,0.25774844142893255,0.25765813588505054,0.25884031755041453,0.2583477418565129,0.2583477418565129,0.25814250198405386,0.2582245979330375,0.26033446382191616,0.2605725420739686,0.2616562086005522,0.2619107060424014,0.2617465141444342,0.2612703576403293,0.26232118578731944,0.2616479990056539,0.26232118578731944,0.2629369054046965,0.2616562086005522,0.26110616574236206,0.26140171115870303,0.2625182160648801,0.2634787386679883,0.2643735845119096,0.2649810945343883,0.2662289529589391,0.2654572510384932,0.2655311373925785,0.2663603064773129,0.2657774252395293,0.26445568046089324,0.2646280819537588,0.2634623194781916,0.26375786489453257,0.2634623194781916,0.2626906175577457,0.2629204862148998,0.26354441542717516,0.26251000646998174,0.26282197107611943,0.2640369911210768,0.2638974280078047,0.26382354165371946,0.26282197107611943,0.26238686254650634,0.2631339356822571,0.23746253243508325,0.2106089475225454,0.1848308195416928,0.15870788857510906,0.0)
m <- c(0.16030875768250824,0.18809648776437785,0.21515924890251648,0.24277397503190482,0.26961430251685325,0.2699026424376553,0.2695731110995958,0.27103128727050924,0.26976259161898003,0.26947425169817796,0.2691859117773759,0.26855980223506276,0.26955663453269285,0.2697214002017226,0.2693012477456967,0.26851037253435384,0.2689305249903797,0.26817260291284284,0.2679336926927497,0.2679666458265556,0.26800783724381305,0.2672663917331791,0.2660553640658104,0.26467957072941184,0.26536334825588537,0.2656187350428815,0.2665167079390937,0.2666320439074146,0.2672663917331791,0.26800783724381305,0.2679172161258467,0.26787602470858923,0.2668791924109592,0.26716753233176127,0.2672911065835336,0.2682467474639062,0.2690458609587006,0.26912000550976395,0.2684362279832905,0.2675712082208842,0.2684856576839994,0.2697049236348196,0.27138553345892324,0.27158325226175895,0.27144320144308365,0.2713525803251173,0.2697214002017226,0.2688234273055104,0.2688481421558649,0.269070575809055,0.2688316655889619,0.2681973177631973,0.2671263409145038,0.26686271584405624,0.2658164538457172,0.2667309033088324,0.2667968095764443,0.26802431381071606,0.26989440415420385,0.27060289653103187,0.2694083454305661,0.26928477117879374,0.2706358496648378,0.2719374984501729,0.2735357254397616,0.27388173334472415,0.27444193661942534,0.27477970624093634,0.2742442178165896,0.275364624365992,0.2759001127903387,0.2761390230104319,0.27485385079199975,0.27400530759649644,0.273272100369314,0.2732061941017021,0.273272100369314,0.2724565103076167,0.2727118970946128,0.2716738733797253,0.27247298687451965,0.27290961589744855,0.27374992080950034,0.2748126593747423,0.2762790738291072,0.2770946638908045,0.2769710896390322,0.27796792193666225,0.2783468829754307,0.27952495750899353,0.27998630138227687,0.28012635220095217,0.2810819930813248,0.2810902313647763,0.28057121950733255,0.2797473911621837,0.28006868421679176,0.2793354769896093,0.27811621103878903,0.28034878585414236,0.28481393548484896,0.2917999998517109,0.2987613493682184,0.3565364312135049,0.41908147917720306,0.48093451133097626,0.5460828568653446,0.6143040821271182,0.6890005981817614,0.7599651718328805,0.8305095930279737,0.8974868374885725,0.961877260945404,0.9781973004628021,0.9919799486771418,1.0054824952541308,1.0162581700086775,1.0264736414885227,1.0298595759870843,1.0338716200279592,1.0349096437428467,1.0401244771676386,1.0459159904340347,1.0507271479697038,1.0525972383131916,1.0575813998013421,1.062977475462067,1.0653748159464498,1.0696422467743207,1.072583313966502,1.0783913037998012,1.07943756579814,1.0832766058865335,1.0850643133955065,1.0871568373921845,1.0878323766352065,1.088194861107072,1.087198028809442,1.085459751001178,1.0858387120399464,1.0851714110803758,1.0859622862917189,1.0859870011420731,1.084462918703548,1.0842322467669063,1.0832436527527276,1.0853691298832115,1.0888456854997397,1.0936486047519571,1.096342523440594,1.0949008238365834,1.094068757207983,1.0887962557990307,1.0809122185359565,1.019388717720243,0.9552042513496986,0.8839678143446804,0.8106470916264357,0.7330754146472231,0.6477020832394512,0.5678319251772734,0.48770638032809954,0.41244966099875513,0.34190523980366194,0.32567582140423024,0.31154716528492804,0.30109278358498953,0.2937359964628106,0.2890236983285594,0.29203067178835257,0.29362066049448976,0.2959850478450669,0.29754208341739813,0.29844829459706185,0.2977150873698794,0.2979292827396181,0.29864601339989755,0.2996016542802702,0.3001618575549714,0.30124931097056784,0.3022461432681979,0.30244386207103363,0.3019578033473958,0.303902038241947,0.30512954247621876,0.30582155828614377,0.3062664255925241,0.30660419521403515,0.30635704671049047,0.3070902539376729,0.30750216811024733,0.3078728908655643,0.3092816373357688,0.3080623713849485,0.3085731449589408,0.31029494620030185,0.31188493490643904,0.313301919660095,0.31614412745085846,0.31663018617449623,0.3180554092116037,0.3193652962803903,0.3188133312891406,0.3196948276184498,0.32042803484563226,0.3210541443879454,0.32184501959928824,0.3216802539302585,0.32130129289149,0.3232125746522353,0.2907784527037264,0.25882215119540375,0.2280933539213529,0.19668901740428,0.0)
ycorr <- c(0.00033721781638320557,0.00033214536476687957,0.0003169458489261897,0.0002915530259310274,0.0002559136357731327,0.00020996568399889756,0.00015364299119172896,9.723132634537975e-05,4.062945883059767e-05,-1.6226789966618782e-05,-7.336779361257091e-05,-0.00013083391338897715,-0.00018865976883936957,-0.0002468463889326703,-0.0003053814050751158,-0.00036422387428659033,-0.0004233899164040376,-0.00048288270377320943,-0.0005426417489773899,-0.0006026075419475946,-0.0006627393610973904,-0.0007230149323793071,-0.0007834150762146437,-0.0008438996499139904,-0.000904480137356541,-0.0009651212308181767,-0.0010257936454662604,-0.001086446639750332,-0.0011471166452141819,-0.0012078507256866157,-0.0012687355934674635,-0.0013298157459677178,-0.0013910107383563978,-0.0014522650092181526,-0.0015134703031309627,-0.001574484475954617,-0.0016345819328308848,-0.0016930524718898191,-0.0017491525130292828,-0.001802142638547915,-0.001851287708036725,-0.0018958151558108019,-0.0019351434452204803,-0.001968777219098193,-0.0019962538361214376,-0.0020172255147734987,-0.0020319887872140797,-0.002041416081015501,-0.002046367430604798,-0.0020476895958123353,-0.002046136314568304,-0.002042481967474347,-0.0020374651043834732,-0.002031684240715367,-0.0020257117428422408,-0.0020200663364808393,-0.0020151760105639334,-0.002010879015966832,-0.002007027258674152,-0.0020034873427875583,-0.002000174015525372,-0.0019970316257087134,-0.001993979110441905,-0.0019909729511152128,-0.001987960318116163,-0.0019849469571167327,-0.001981933441865199,-0.0019789311078182415,-0.0019759278689285044,-0.00197292586676922,-0.001969908934747046,-0.001966868187282706,-0.001963783499973989,-0.0019606406845634815,-0.0019574488921397996,-0.001954178619350438,-0.0019508113625323284,-0.001947352246143122,-0.0019438126446217683,-0.001940192171962508,-0.00193648935062383,-0.0019327051355886985,-0.001928846214244742,-0.0019249247845956594,-0.0019209234475677536,-0.0019168281795689792,-0.0019126260105822757,-0.0019082498285077133,-0.001903577254330826,-0.0018983973287592815,-0.0018924399911216675,-0.0018853533295256815,-0.0018763997283649627,-0.0018646463451140961,-0.001849128472373418,-0.001828847454962283,-0.0018013101798827825,-0.0017720571620791486,-0.001738969389742119,-0.001701164075750245,-0.001657875008811277,-0.0016084291102293196,-0.0015523481690236964,-0.0014898589055614368,-0.0014214360090430696,-0.001347676602457681,-0.001269315453712934,-0.0011886315196179785,-0.001099970779016206,-0.0010053607061442284,-0.0009056410431611693,-0.000801653615681297,-0.0006942286632103086,-0.000584069085251911,-0.00047157079217661357,-0.0003570737526853847,-0.00024081235965131708,-0.00012296810673455454,-3.650991421539761e-06,0.00011708378708592237,0.00023916428455128639,0.00036251883516604644,0.0004871049213894547,0.0006128586042681923,0.0007396978985763946,0.0008675377279671293,0.000996288002574165,0.0011258262428114165,0.001256055860727652,0.0013868638209461352,0.0015181610758107408,0.0016498688563044168,0.0017819157157057753,0.0019142627167131273,0.0020468813497890115,0.002179750625940044,0.002312834189002569,0.0024460769750279275,0.002579376714414837,0.002712546563719679,0.0028452084019679573,0.002976800150616841,0.0031065735783878186,0.0032335419268106932,0.003356476858228114,0.0034739597090216456,0.003584415956608761,0.0036861335326179453,0.0037773095370730726,0.00385616312577269,0.003921132259424037,0.00397095709814571,0.004004726846113834,0.004021876078781532,0.0040222985687095175,0.004006295004147234,0.00397454454000983,0.003928059385714167,0.0038681869168276594,0.0037965110320776394,0.003714686457484786,0.003624302860949848,0.0035268433472753257,0.003423656146662144,0.003315915856539595,0.0032045891920845617,0.003090443876343786,0.002974088021862158,0.002855936162062486,0.0027362432009144966,0.002615147992956608,0.0024927700655659776,0.002369163386268723,0.002244395810961315,0.002118500125902969,0.0019915542989764595,0.001863615856889669,0.001734760917467437,0.001605080475104294,0.0014746797194937313,0.0013436782158979788,0.0012121833218430814,0.0010802900536350107,0.0009480803034073104,0.0008156389626704545,0.00068301799975616,0.0005502766801030842,0.00041746713566055894,0.00028463751555487426,0.0001518454820830616,1.9200719579940412e-05,-0.00011313525454162231,-0.0002448715821135781,-0.0003756342395349767,-0.0005049412147024191,-0.0006322074845320565,-0.000756759785028109,-0.0008778724181478157,-0.000994760642629891,-0.0010995762390339902,-0.0011845047671681876,-0.001248856563380352,-0.0012920723131398819,-0.0013137870111956944)
xcorr <- c(-102.0,-100.99507389162562,-99.99014778325123,-98.98522167487684,-97.98029556650246,-96.97536945812809,-95.9704433497537,-94.9655172413793,-93.96059113300493,-92.95566502463055,-91.95073891625616,-90.94581280788177,-89.94088669950739,-88.93596059113301,-87.93103448275862,-86.92610837438423,-85.92118226600985,-84.91625615763547,-83.91133004926108,-82.90640394088669,-81.90147783251231,-80.89655172413794,-79.89162561576354,-78.88669950738915,-77.88177339901478,-76.8768472906404,-75.87192118226601,-74.86699507389162,-73.86206896551724,-72.85714285714286,-71.85221674876847,-70.84729064039408,-69.8423645320197,-68.83743842364532,-67.83251231527093,-66.82758620689654,-65.82266009852216,-64.81773399014779,-63.812807881773395,-62.80788177339901,-61.802955665024626,-60.79802955665024,-59.79310344827586,-58.78817733990147,-57.78325123152709,-56.778325123152705,-55.77339901477832,-54.768472906403936,-53.76354679802955,-52.75862068965517,-51.75369458128078,-50.7487684729064,-49.743842364532014,-48.73891625615763,-47.733990147783246,-46.72906403940886,-45.72413793103448,-44.71921182266009,-43.71428571428571,-42.709359605911324,-41.70443349753694,-40.699507389162555,-39.69458128078817,-38.68965517241379,-37.6847290640394,-36.679802955665025,-35.67487684729063,-34.66995073891624,-33.665024630541865,-32.66009852216749,-31.655172413793096,-30.650246305418705,-29.645320197044327,-28.64039408866995,-27.63546798029556,-26.630541871921167,-25.62561576354679,-24.620689655172413,-23.61576354679802,-22.61083743842363,-21.605911330049253,-20.600985221674875,-19.596059113300484,-18.591133004926093,-17.586206896551715,-16.581280788177338,-15.576354679802947,-14.571428571428555,-13.566502463054178,-12.5615763546798,-11.55665024630541,-10.551724137931018,-9.54679802955664,-8.541871921182263,-7.536945812807872,-6.5320197044334805,-5.527093596059103,-4.522167487684726,-3.5172413793103345,-2.512315270935943,-1.5073891625615659,-0.5024630541871886,0.5024630541872028,1.5073891625615943,2.5123152709359715,3.5172413793103487,4.52216748768474,5.527093596059132,6.532019704433509,7.536945812807886,8.541871921182278,9.546798029556669,10.551724137931046,11.556650246305423,12.561576354679815,13.566502463054206,14.571428571428584,15.57635467980296,16.581280788177352,17.586206896551744,18.59113300492612,19.596059113300498,20.60098522167489,21.60591133004928,22.61083743842366,23.615763546798036,24.620689655172427,25.62561576354682,26.630541871921196,27.635467980295573,28.64039408866995,29.645320197044356,30.650246305418733,31.65517241379311,32.660098522167516,33.66502463054189,34.66995073891627,35.67487684729065,36.679802955665025,37.68472906403943,38.68965517241381,39.694581280788185,40.69950738916259,41.70443349753697,42.709359605911345,43.71428571428572,44.7192118226601,45.724137931034505,46.72906403940888,47.73399014778326,48.738916256157665,49.74384236453204,50.74876847290642,51.7536945812808,52.758620689655174,53.76354679802958,54.76847290640396,55.773399014778335,56.77832512315274,57.78325123152712,58.788177339901495,59.79310344827587,60.79802955665025,61.802955665024655,62.80788177339903,63.81280788177341,64.81773399014781,65.82266009852219,66.82758620689657,67.83251231527095,68.83743842364532,69.84236453201973,70.8472906403941,71.85221674876848,72.85714285714289,73.86206896551727,74.86699507389164,75.87192118226602,76.8768472906404,77.8817733990148,78.88669950738918,79.89162561576356,80.89655172413796,81.90147783251234,82.90640394088672,83.9113300492611,84.91625615763547,85.92118226600988,86.92610837438426,87.93103448275863,88.93596059113304,89.94088669950742,90.9458128078818,91.95073891625617,92.95566502463055,93.96059113300495,94.96551724137933,95.97044334975371,96.97536945812811,97.98029556650249,98.98522167487687,99.99014778325125,100.99507389162562,102.0)
altd  <- c(52)
x <- seq.int((length(p)-1)/2*-1,(length(p)-1)/2)
pdf('predictd_model.pdf',height=6,width=6)
plot(x,p,type='l',col=c('red'),main='Peak Model',xlab='Distance to the middle',ylab='Percentage')
lines(x,m,col=c('blue'))
legend('topleft',c('forward tags','reverse tags'),lty=c(1,1,1),col=c('red','blue'))
plot(xcorr,ycorr,type='l',col=c('black'),main='Cross-Correlation',xlab='Lag between + and - tags',ylab='Correlation')
abline(v=altd,lty=2,col=c('red'))
legend('topleft','alternative lag(s)',lty=2,col='red')
legend('right','alt lag(s) : 52',bty='n')
dev.off()

# R script for Peak Model
#  -- generated by MACS
p <- c(0.18539409277975127,0.21722099049875387,0.24920074743329265,0.2806173388369087,0.31231551300598615,0.3138280147176071,0.31409350703932776,0.31517961199182154,0.31647489271294377,0.31781039954341755,0.3169173799158116,0.3158071392977068,0.31638639527237017,0.3169012894720709,0.31708632957508837,0.3176173142185298,0.31824484152441507,0.3184781529586545,0.3179149874277318,0.3169012894720709,0.31584736540705843,0.31707023913134774,0.3149302101138415,0.31372342683329285,0.31344988928970186,0.3113179054940659,0.31044097631020057,0.31011916743538764,0.3108754182911981,0.31129376982845497,0.3116638500344899,0.3105375189726445,0.3109639157317717,0.3124040104465597,0.31072255907566193,0.3116397143688789,0.31196152324369186,0.31158339781578664,0.3113259507159363,0.31042488586645994,0.3110363227286046,0.31118113672227043,0.31229137734037515,0.310996096619253,0.3124522817777816,0.31118918194414075,0.31012721265725796,0.3098214942261856,0.3117523474750634,0.317721902102844,0.3260889328479812,0.3647703596005,0.43259157996733316,0.5009920563088297,0.5749759166283311,0.6512848460683563,0.7336196466892544,0.8185691444180079,0.9008556737076839,0.9796264410400284,1.0542297834435448,1.0977383433182581,1.1114795822727719,1.1244806608152158,1.1329281437790564,1.13971831103761,1.1391631907285575,1.138575889532024,1.1369507547142184,1.1341510175033456,1.1318822649359142,1.1337568016316997,1.1315121847298792,1.1323891139137445,1.1309892453083081,1.130216904008757,1.1281010106568619,1.1268700917107022,1.1245289321464378,1.123861178731201,1.1252610473366373,1.12061090909559,1.1185432870749166,1.1151723391112507,1.1110129594042932,1.106491544713171,1.105300851876363,1.1007231206321484,1.0963143390472108,1.0898218449978592,1.0824121956552906,1.07545307873746,1.0742784763443929,1.0699099208688068,1.0650827877466122,1.0645196222156894,1.0618646989984826,1.0562008628017743,1.0545515923183577,1.0483326358125973,1.0407781724763627,1.0314537603286569,0.9902059077995047,0.9242029075753648,0.8567759030801776,0.7837011528320227,0.7104172268152393,0.6344783775812491,0.5517734967543162,0.4776850485505004,0.4035000576842408,0.33421460693700866,0.29306329707030027,0.2791128823471581,0.2684288277033675,0.25969976197406575,0.25233033874084876,0.24936969709256945,0.2505442994856368,0.2506891134793026,0.25082588225109814,0.25048798293254454,0.2501822645014722,0.249160521323941,0.24924097354264427,0.2490881143271081,0.24836404435877893,0.24831577302755697,0.24905593343962681,0.24847667746496346,0.24879848633977644,0.24960300852680886,0.24950646586436495,0.2498845912922702,0.24914443088020038,0.2492892448738662,0.2502224906108238,0.25002940528593603,0.24945014931127268,0.24945014931127268,0.24946623975501334,0.24867780801172157,0.24809855203705822,0.2484284061337415,0.24827554691820536,0.24730207507189614,0.2457654376946642,0.24708485408139738,0.24727793940628515,0.24681936175967667,0.24665845732227018,0.2477928336059859,0.24848472268683378,0.24784110493720785,0.24848472268683378,0.24848472268683378,0.2495145110862353,0.24776869794037493,0.2483559991369086,0.24961105374867917,0.24973977729860436,0.24840427046813054,0.2463688293349385,0.24797787370900337,0.2487904411179061,0.24947428497688368,0.2498524104047889,0.25187176109424025,0.2517832636536667,0.25047993771067417,0.2506167064824697,0.2509867866885046,0.25312681570601087,0.25239470051581137,0.2517108566568338,0.2518476254286293,0.25185567065049963,0.2513810025601505,0.2510752841290782,0.25224988652214553,0.2520407107535171,0.2516786757693525,0.2521533438597016,0.25196830375668416,0.25150168088820535,0.251791308875537,0.25233033874084876,0.2517189018787041,0.2513568668945395,0.25016617405773156,0.2503190332732677,0.25198439420042484,0.25073738481052454,0.25056038992937746,0.2504155759357116,0.24977195818608566,0.25047189248880386,0.25003745050780635,0.25146145477885373,0.2528050068311979,0.25348885069017546,0.2525395145094772,0.25262801195005075,0.25271650939062434,0.2539554735586543,0.2536417099057116,0.2522016151909236,0.25306245393104826,0.2531831322591031,0.2525475597313475,0.22680284974631001,0.20179830017334235,0.17703510725648441,0.15193401502107284,0.0)
m <- c(0.1475011507671375,0.1715393976393646,0.19572377367190918,0.22020852631177307,0.24524532244616967,0.24297220217456428,0.24428736461742168,0.2439951062967867,0.24282607301424677,0.24259064270040193,0.24290725588108983,0.24403569773020822,0.2434998908090441,0.24376779426962616,0.24306150332809162,0.243150804481619,0.24305338504140733,0.24406817087694543,0.24533462359969702,0.24640623744202528,0.24680403348955623,0.24713688324361274,0.2490203257543715,0.24943435837527106,0.2502705419037545,0.251163553439028,0.2514720483330316,0.25138274717950426,0.2507332842447598,0.25084694025834015,0.25072516595807554,0.2509443596985518,0.25054656365102085,0.2504329076374406,0.2500026384431724,0.24995392872306657,0.24928822921495356,0.2490203257543715,0.2499620470097509,0.24958048753558854,0.2490284440410558,0.24904468061442442,0.24915833662800468,0.24956425096221993,0.24941812180190243,0.25091188655181457,0.2529495765095751,0.2531281788166298,0.2527222644824146,0.2537695234646899,0.255182105347759,0.25545000880834107,0.2555068368151312,0.2554418905216567,0.2569762467049904,0.25760947306636617,0.2582589360011106,0.26013426022518504,0.2609136157468783,0.2617010895552559,0.262634692523951,0.26262657423726665,0.2639498549668084,0.26422587671407477,0.2649402859422936,0.26554103915693217,0.2666126529992604,0.26638534097209987,0.26631227639194116,0.26764367540816714,0.2680252348823295,0.26910496701134207,0.2694621716254515,0.2699898602599313,0.27024964543382907,0.2710127643821537,0.2699736236865627,0.2702821185805663,0.2711426569691026,0.27059873176125415,0.2710858289623125,0.2718245930505842,0.272271098818221,0.2735537881143412,0.27511249915772773,0.2746822299634596,0.27557524149873314,0.2751206174444121,0.2763545970204264,0.2774099742893861,0.27923658879335467,0.27984546029467755,0.2803975037892103,0.2799185248748363,0.27951261054062104,0.27983734200799326,0.27937459966698786,0.2788875024659296,0.27802696407739325,0.2792609436534076,0.28271933378092157,0.28868627449388573,0.2976488629933584,0.36198628496647556,0.4278824179829792,0.4944686053676488,0.5680852290209265,0.6415719600872554,0.7229253109506757,0.8025007570302333,0.877659855153529,0.9490926596887287,1.021077507718461,1.0364778975585875,1.0500516728947455,1.0643885671792281,1.073724596866179,1.08317428256671,1.082882024246075,1.0844975632962517,1.0856178868586859,1.0890113306927254,1.0911951498108032,1.0956196160537495,1.1012049972925515,1.103591773577737,1.103405052983998,1.1095100045705955,1.113122642145111,1.114259202280914,1.1187648513907031,1.122036520924478,1.1221014672179526,1.122117703791321,1.1229051775996985,1.1246018995167184,1.1290344840463489,1.1249753407041965,1.1250889967177766,1.1249347492707749,1.1259414168196287,1.1259008253862073,1.1263554494405283,1.1283119565314457,1.125624803638941,1.1251295881511982,1.1198364652330313,1.1220040477777409,1.1221095855046368,1.1236682965480234,1.119641626352608,1.113017104418215,1.1073505403125703,1.0973244562574536,1.029837139050826,0.9607911108008121,0.8913310499298986,0.8138420035282073,0.7349160203833942,0.6474820727934294,0.5632142570103436,0.48463736019295545,0.4062309473959378,0.3319810973812843,0.3157445240126743,0.3007094570733414,0.2890353608213108,0.28195621483259686,0.2768011027880632,0.27840040526487125,0.2801620734753655,0.2810388484372704,0.2818182039589637,0.28128239703779956,0.28270309720755293,0.2841237973773063,0.2851304649261601,0.2846027762916803,0.2857718095742202,0.2878825641121395,0.28875122078736015,0.2897741249095826,0.29108928735244,0.29083762046522654,0.2897903614829512,0.2883453064531449,0.2884995539001467,0.2886375647737799,0.28857261848030547,0.28888111337430905,0.289944608929953,0.2897741249095826,0.28973353347616104,0.29217713776813686,0.2938170316783665,0.2955218718820705,0.29669902345129473,0.298728595122371,0.3005227364796024,0.3002710695923889,0.30082311308692167,0.3023899424169926,0.3036076854196383,0.3035914488462697,0.3049147295758114,0.3068631183800446,0.3074313984479459,0.3070985486938895,0.3064166126124078,0.3066926343596742,0.276395188453848,0.24585419394749256,0.21502094112050216,0.1845205380475683,0.0)
ycorr <- c(0.0002941766370134841,0.00028888067609697527,0.0002730038276288812,0.00024648112045024423,0.0002092753108968858,0.00016130570075038815,0.00010245727967018757,4.359829655199795e-05,-1.5333528087645756e-05,-7.44440984952225e-05,-0.0001337648506478582,-0.00019330495725308408,-0.00025309733251691535,-0.00031316804333317473,-0.0003734698945929754,-0.0004339760471231133,-0.0004946747940839809,-0.0005554964405629173,-0.0006164386115568452,-0.0006774577266097626,-0.000738512566376567,-0.000799597475458621,-0.0008607423246635422,-0.0009219168263426001,-0.000983103797170742,-0.0010443386257084682,-0.0011055901316868145,-0.001166856421424698,-0.0012281235996649436,-0.0012894034940629255,-0.0013507325726869106,-0.001412110251193157,-0.0014734486274930992,-0.0015346499208936078,-0.0015956166878351758,-0.0016562235820468112,-0.001715729262189087,-0.0017734449344564552,-0.0018286597328998407,-0.001880671030670333,-0.0019287634207510432,-0.001972259804592122,-0.0020105603610519602,-0.0020432033617415702,-0.0020697535327166704,-0.0020898121621185945,-0.0021036077238443317,-0.002111958008410045,-0.002115672739677407,-0.0021155326414262,-0.0021123085643180313,-0.0021067266311621193,-0.002099488532424865,-0.002091179744244921,-0.002082347985714367,-0.002073495046388114,-0.0020651155756899724,-0.0020571052440888963,-0.00204936535473827,-0.0020418014614677358,-0.0020343356387272312,-0.002026931883386999,-0.0020195364513618417,-0.0020121386258516337,-0.002004741426177382,-0.001997329572786945,-0.001989919086130963,-0.001982494819204766,-0.001975060243241511,-0.0019676051934903868,-0.001960138738518535,-0.001952658149178947,-0.001945166531112168,-0.0019376557829682347,-0.0019301066848948403,-0.0019225367108859932,-0.0019149386454005582,-0.0019073164519903146,-0.0018996782757229797,-0.0018920234671162075,-0.0018843521045587598,-0.0018766425821960316,-0.0018688866048505073,-0.0018610750788025533,-0.00185320604781563,-0.0018452518924387154,-0.0018371717110458516,-0.0018289322054973883,-0.0018204081509537518,-0.0018113989838945532,-0.0018016167030801009,-0.0017907064179406578,-0.0017779775249344171,-0.0017625428335983574,-0.0017434490139807998,-0.0017197004117463417,-0.0016890693140027835,-0.0016564364419118449,-0.0016198341873076315,-0.0015783911167989281,-0.001531349344701824,-0.0014780726547218436,-0.0014181339685267,-0.0013517187103881895,-0.001279290857399176,-0.001201483593658225,-0.0011190416209274456,-0.001034038344525409,-0.0009414912328058877,-0.0008433022799041249,-0.000740367445172946,-0.0006335516537838417,-0.0005236909658721166,-0.00041149581099235064,-0.00029741851168520753,-0.00018178634626117595,-6.48250743272942e-05,5.329783615873525e-05,0.000172483799022567,0.00029269446827882145,0.0004139021941278806,0.0005360620175315963,0.0006591339337411535,0.0007830887372985802,0.0009078933452353803,0.0010335104379669568,0.0011598589918327819,0.0012868603818016189,0.0014144384894474598,0.0015425156341060638,0.001671009920874199,0.001799842548965147,0.001928965017217535,0.0020583091669117673,0.0021878136277487413,0.002317421195748224,0.0024470450945170918,0.0025765755453936315,0.0027058658153694785,0.002834661608686092,0.0029625228656503895,0.0030888445455941214,0.003212835640563373,0.003333511436381579,0.003449685945092977,0.0035599501739277703,0.003662751895392005,0.0037564313145714316,0.0038392390808181013,0.0039094418545585295,0.003965549868300901,0.004006410361422024,0.004031186866919969,0.004039404662818822,0.0040309819671734675,0.004006281184346457,0.003966050516655,0.00391137325850884,0.0038436286775185803,0.003764458866099238,0.0036755605317598562,0.0035785166154275218,0.0034748005868128202,0.00336576013657443,0.003252562043907761,0.003136155233420685,0.0030172924305790663,0.0028965481426683273,0.0027743153547579147,0.0026508293507541397,0.00252620666744681,0.0024005498199997,0.0022739322155612557,0.0021463908866418916,0.002017967565866209,0.0018887168113018553,0.001758700627776033,0.0016279704481226953,0.0014966090721705817,0.0013646871374788623,0.0012323046489678712,0.0010995441707999476,0.0009664751627668084,0.000833188371730857,0.0006997578678033821,0.0005662468401213056,0.000432727125380787,0.00029929945998897616,0.0001660526265201636,3.309379447729494e-05,-9.941615583070938e-05,-0.00023125373978140706,-0.0003621051594305225,-0.0004915657598436054,-0.0006191728809185677,-0.0007443379418040827,-0.0008664115832616883,-0.0009847261669288655,-0.0010986057129781452,-0.001200519753671536,-0.0012829790207249273,-0.0013453988800203346,-0.001387306997758377,-0.0014083534553454772)
xcorr <- c(-102.0,-100.99507389162562,-99.99014778325123,-98.98522167487684,-97.98029556650246,-96.97536945812809,-95.9704433497537,-94.9655172413793,-93.96059113300493,-92.95566502463055,-91.95073891625616,-90.94581280788177,-89.94088669950739,-88.93596059113301,-87.93103448275862,-86.92610837438423,-85.92118226600985,-84.91625615763547,-83.91133004926108,-82.90640394088669,-81.90147783251231,-80.89655172413794,-79.89162561576354,-78.88669950738915,-77.88177339901478,-76.8768472906404,-75.87192118226601,-74.86699507389162,-73.86206896551724,-72.85714285714286,-71.85221674876847,-70.84729064039408,-69.8423645320197,-68.83743842364532,-67.83251231527093,-66.82758620689654,-65.82266009852216,-64.81773399014779,-63.812807881773395,-62.80788177339901,-61.802955665024626,-60.79802955665024,-59.79310344827586,-58.78817733990147,-57.78325123152709,-56.778325123152705,-55.77339901477832,-54.768472906403936,-53.76354679802955,-52.75862068965517,-51.75369458128078,-50.7487684729064,-49.743842364532014,-48.73891625615763,-47.733990147783246,-46.72906403940886,-45.72413793103448,-44.71921182266009,-43.71428571428571,-42.709359605911324,-41.70443349753694,-40.699507389162555,-39.69458128078817,-38.68965517241379,-37.6847290640394,-36.679802955665025,-35.67487684729063,-34.66995073891624,-33.665024630541865,-32.66009852216749,-31.655172413793096,-30.650246305418705,-29.645320197044327,-28.64039408866995,-27.63546798029556,-26.630541871921167,-25.62561576354679,-24.620689655172413,-23.61576354679802,-22.61083743842363,-21.605911330049253,-20.600985221674875,-19.596059113300484,-18.591133004926093,-17.586206896551715,-16.581280788177338,-15.576354679802947,-14.571428571428555,-13.566502463054178,-12.5615763546798,-11.55665024630541,-10.551724137931018,-9.54679802955664,-8.541871921182263,-7.536945812807872,-6.5320197044334805,-5.527093596059103,-4.522167487684726,-3.5172413793103345,-2.512315270935943,-1.5073891625615659,-0.5024630541871886,0.5024630541872028,1.5073891625615943,2.5123152709359715,3.5172413793103487,4.52216748768474,5.527093596059132,6.532019704433509,7.536945812807886,8.541871921182278,9.546798029556669,10.551724137931046,11.556650246305423,12.561576354679815,13.566502463054206,14.571428571428584,15.57635467980296,16.581280788177352,17.586206896551744,18.59113300492612,19.596059113300498,20.60098522167489,21.60591133004928,22.61083743842366,23.615763546798036,24.620689655172427,25.62561576354682,26.630541871921196,27.635467980295573,28.64039408866995,29.645320197044356,30.650246305418733,31.65517241379311,32.660098522167516,33.66502463054189,34.66995073891627,35.67487684729065,36.679802955665025,37.68472906403943,38.68965517241381,39.694581280788185,40.69950738916259,41.70443349753697,42.709359605911345,43.71428571428572,44.7192118226601,45.724137931034505,46.72906403940888,47.73399014778326,48.738916256157665,49.74384236453204,50.74876847290642,51.7536945812808,52.758620689655174,53.76354679802958,54.76847290640396,55.773399014778335,56.77832512315274,57.78325123152712,58.788177339901495,59.79310344827587,60.79802955665025,61.802955665024655,62.80788177339903,63.81280788177341,64.81773399014781,65.82266009852219,66.82758620689657,67.83251231527095,68.83743842364532,69.84236453201973,70.8472906403941,71.85221674876848,72.85714285714289,73.86206896551727,74.86699507389164,75.87192118226602,76.8768472906404,77.8817733990148,78.88669950738918,79.89162561576356,80.89655172413796,81.90147783251234,82.90640394088672,83.9113300492611,84.91625615763547,85.92118226600988,86.92610837438426,87.93103448275863,88.93596059113304,89.94088669950742,90.9458128078818,91.95073891625617,92.95566502463055,93.96059113300495,94.96551724137933,95.97044334975371,96.97536945812811,97.98029556650249,98.98522167487687,99.99014778325125,100.99507389162562,102.0)
altd  <- c(51)
x <- seq.int((length(p)-1)/2*-1,(length(p)-1)/2)
pdf('predictd_model.pdf',height=6,width=6)
plot(x,p,type='l',col=c('red'),main='Peak Model',xlab='Distance to the middle',ylab='Percentage')
lines(x,m,col=c('blue'))
legend('topleft',c('forward tags','reverse tags'),lty=c(1,1,1),col=c('red','blue'))
plot(xcorr,ycorr,type='l',col=c('black'),main='Cross-Correlation',xlab='Lag between + and - tags',ylab='Correlation')
abline(v=altd,lty=2,col=c('red'))
legend('topleft','alternative lag(s)',lty=2,col='red')
legend('right','alt lag(s) : 51',bty='n')
dev.off()

# R script for Peak Model
#  -- generated by MACS
p <- c(0.2525029715655411,0.29464759357165865,0.3365851893644128,0.3793706067928455,0.42212644904794067,0.4217518301856641,0.4212490522389244,0.4203617970387956,0.4206378319899468,0.4207955662477475,0.4197702935720431,0.4186661537674384,0.41933652436309127,0.4172169702738947,0.4151171329669232,0.41446647915349544,0.4148706731891097,0.41373695821116735,0.4134904984333538,0.4123765002376365,0.4120511733309226,0.4116174041219708,0.40945841646832404,0.4107498657040671,0.41065128179294164,0.4113019356063694,0.41083859122407995,0.4110554758285559,0.4107794408774047,0.4115089618197328,0.4119723062020223,0.4108287328329674,0.41231734989096125,0.41147938664639516,0.411893439073122,0.41025694614843994,0.40992176085061355,0.4101977958017647,0.41002034476173893,0.4095077084238868,0.40877818748155864,0.4104245387973532,0.4086993203526583,0.40825569275259393,0.40651075752567395,0.40475596390764146,0.40116750954267616,0.3992451232757304,0.40308989580962185,0.4081866840148061,0.4184196939896248,0.4451753674690641,0.49140136339577406,0.5397271966294556,0.5912274318013755,0.6487610023341712,0.7119434309744537,0.7754018945658873,0.8314665648229143,0.8853328138618443,0.9326925247664967,0.9620803886729846,0.9716233112699254,0.9789678126487693,0.9833055047382878,0.9837688491205773,0.9807423230490269,0.9738808828346975,0.9682813166827736,0.9605720548327658,0.9547358872941408,0.9505657878535355,0.9461985205906793,0.9405398040920802,0.935699334055822,0.9300307591661102,0.9234847874673823,0.91769791188432,0.9128673002391744,0.9093281378297718,0.9057889754203692,0.899657056148368,0.89718259997912,0.8932885354896658,0.8902028590714401,0.8859243173285969,0.8816556339768661,0.8747350434158615,0.8697072639484651,0.8632204425964124,0.8581828047379033,0.8548999604974268,0.8477822021141714,0.8419066010110963,0.836208450948047,0.8303328498449719,0.8238854620573693,0.821696899230385,0.8159297404295478,0.8102710239309486,0.8020885593075388,0.7898345791546488,0.7658392551867214,0.7288111381680132,0.6884410265621532,0.6462569709915855,0.601766051900683,0.5535880945336897,0.505311553255571,0.4584250451243207,0.41572835321590085,0.37556526782340427,0.3494010978107175,0.3370879673111524,0.32686481572744625,0.3198752164286539,0.3167402480548655,0.3149460208723828,0.31565582503248585,0.3171050085260296,0.31569525859693603,0.3147587114412445,0.31291519230319914,0.31176176054303173,0.3120377954941829,0.3107857798228901,0.30911971172487046,0.3086366505603559,0.30633964543113357,0.3040130651285736,0.30198223655938994,0.30224841311942857,0.3025145896794672,0.3017949271282517,0.29982324890574324,0.2988965601411643,0.2990050024434022,0.2977332699898843,0.2984627909322124,0.2984134989766497,0.2988472681856016,0.2967770060519677,0.29631366166967826,0.29533768094953655,0.29509122117172304,0.2952982473850864,0.29343501146481593,0.2925576146557997,0.2899845745754262,0.28880156764192116,0.2882692145218439,0.2901028752687767,0.2887917092508086,0.288998735464172,0.2890184522463971,0.28825935613073134,0.2881903473929435,0.2888410012063713,0.29004372492210145,0.2904183437843781,0.2906845203444167,0.2896789644509374,0.2893930711086737,0.2887029837307957,0.28786502048622964,0.2879143124417924,0.28797346278846764,0.28769742783731644,0.28764813588175375,0.2873326673661524,0.2864749873393612,0.28617923560598496,0.28679045585496254,0.2888311428152588,0.28917618650419774,0.2880819050907056,0.2885846830374452,0.28825935613073134,0.2889297267263842,0.2884368071707571,0.28924519524198555,0.289708539624275,0.28853539108188253,0.2871946498905768,0.2885058159085449,0.289471938237574,0.2901916007887896,0.2900141497487638,0.2893832127175611,0.29083239621110485,0.2900141497487638,0.2895409469753618,0.2905366444777286,0.29128588220228174,0.29072395390886685,0.29195625279793463,0.29013245044211433,0.292163279011298,0.2926069066113624,0.29164078428233325,0.29183795210458413,0.29303081742920173,0.29355331215816644,0.2924393139624492,0.291216873464494,0.29099998886001804,0.2915027668067577,0.2900338665309889,0.28931420397977337,0.2892649120242106,0.2603699676733497,0.2301441405222956,0.20096330282917094,0.17238382699391136,0.0)
m <- c(0.17009402131479487,0.19915756598845413,0.22710443244480644,0.2555398456212305,0.28414475459849586,0.2842843393756592,0.2851617294035433,0.2848526488255387,0.28578986090077846,0.28526143281580285,0.284104873233592,0.28347674173635684,0.28436410210546686,0.2841547249397218,0.2838655850441691,0.2843142503993371,0.28394534777397673,0.284334191081789,0.28314772047590037,0.28492244121412036,0.2856901574885189,0.2861487931849128,0.28519164042722117,0.28561039475871125,0.2862185855734945,0.28521158110967304,0.28481276746063483,0.2855804837350334,0.28663733990498463,0.2853810769105143,0.2858098015832304,0.28625846693839835,0.287664285051258,0.2877540181222916,0.2881328910888779,0.289000310775536,0.29007710762793915,0.28923959896495893,0.28756458163899845,0.28857158610281997,0.2890701031641177,0.28877099292733904,0.2882525351835894,0.2886712895150795,0.2884718826905604,0.28837217927830083,0.289000310775536,0.2909146162909194,0.2928787735124326,0.2947033459567824,0.2956006766671183,0.2959695792924787,0.29660768113093977,0.2982727281156743,0.2986516010822606,0.3007653134221631,0.30094477956423027,0.3015430000377876,0.30168258481495097,0.30169255515617693,0.3026397375726427,0.302789292691032,0.3044742803582184,0.30438454728718484,0.30704662839451485,0.3073257979488416,0.30922016278177306,0.30950930267732574,0.3099679383737197,0.3097984425728785,0.3104564850937915,0.3122710871969153,0.3128393966467948,0.31467393943237054,0.3134874688264819,0.31436485885436594,0.31429506646578426,0.31495310898669726,0.31635892709955693,0.31805388510796934,0.3191506226428244,0.32024736017767946,0.3203071822250352,0.3196092583392183,0.3202573305189054,0.32121448327659713,0.3218525851150582,0.3233281956164996,0.3245445772460661,0.3243352000803211,0.32523253079065706,0.3254119969327242,0.3265984675386129,0.3288517646556788,0.3307361591473843,0.3310552100666148,0.3305068412991873,0.330576633687769,0.3291010231863276,0.33156369746913855,0.3347741473438961,0.34154400903631965,0.3509460408123954,0.38567273930239715,0.4238591461978054,0.4643686425988612,0.5094046739165006,0.5548295485419522,0.6063861830213664,0.6543235836357587,0.6978840044519568,0.7421622898364236,0.7817445445034655,0.7965106198591051,0.808754198884578,0.8186946290868553,0.8269999233280759,0.8324437296374475,0.834786759825547,0.8386951335861214,0.8450263002646029,0.8484261866226536,0.8546676202301016,0.8609589055436793,0.8645581987262491,0.8689052675007655,0.8733420693463155,0.8804708633228735,0.885675381442822,0.8884471363036376,0.8926346796185387,0.8973107696535118,0.9026050208444939,0.9040108389573536,0.907231259173337,0.9120170229617955,0.914589370998092,0.9178995242851091,0.9218477794105874,0.9275607849330596,0.9303026287701973,0.9333136718204358,0.9373815710406255,0.9423168899474732,0.9474117343139363,0.9516291886525153,0.95637507107607,0.9622476020581576,0.9685388873717353,0.9743615666476931,0.9760664949973314,0.9770435884374751,0.970373430157311,0.9609614280400094,0.9222266523771736,0.8773900278840533,0.828335949052354,0.7721730169265486,0.712729842537404,0.6484410823124451,0.5905233701308717,0.5331839377404036,0.48083964630413906,0.43200491497941074,0.41279206743699515,0.39917258132234046,0.3909869311758313,0.3869290022968675,0.3836188490098504,0.38668971410744457,0.3894415282858082,0.39025909626633654,0.3911963083415763,0.3925622450895322,0.3940278852497476,0.39536391097402557,0.3951146524433767,0.39543370336260725,0.39627121202558746,0.3962911527080394,0.3960718052010684,0.3978265852568365,0.39806587344625943,0.39806587344625943,0.39914267029866257,0.3991027889337587,0.40054848841152224,0.40007988237390235,0.4001197637388062,0.401705047993733,0.40206398027786744,0.4016053445814735,0.40261234904529497,0.403938404428347,0.4035096797556309,0.40385864169853936,0.40367917555647215,0.404377099442289,0.40506505298687995,0.4056134217543075,0.4071388839618786,0.4084649393449306,0.4089933674299063,0.4094520031263002,0.4117750926319477,0.4122038173046638,0.41346008029913417,0.41570340707497405,0.4168101149510551,0.41739836508338646,0.3756425760290863,0.3337771132213006,0.29258963361687984,0.251442035377363,0.0)
ycorr <- c(0.0004719370491884679,0.0004662515940268218,0.00044915963283598275,0.0004205729014122184,0.0003803578097323303,0.0003283532176712491,0.0002644603026514233,0.00020037714884384394,0.00013594159928964131,7.099307810676646e-05,5.426293776005291e-06,-6.0827725557013395e-05,-0.0001277682457758251,-0.00019534649611839316,-0.0002635861852160982,-0.00033237145502997613,-0.00040168332470105533,-0.0004715745535147709,-0.0005420045346126862,-0.0006129565197668378,-0.0006844048357590368,-0.0007563744558171421,-0.0008288766113882549,-0.0009018995687312288,-0.000975466951441119,-0.001049576618026077,-0.0011242979801401886,-0.0011996171799450242,-0.0012755657628772587,-0.0013522099140296177,-0.0014295874793408977,-0.0015076698428173323,-0.0015863027349851848,-0.001665377120298064,-0.0017446334892484287,-0.0018237849601918943,-0.0019019225004941974,-0.0019780740172916397,-0.002051242067484427,-0.0021203787226241637,-0.0021844505459997464,-0.002242436520174706,-0.0022935934257327056,-0.002337336013595724,-0.0023732198017877995,-0.0024009740533321926,-0.002420957172157682,-0.002434192166187179,-0.002441794733613906,-0.0024448589889128967,-0.002444455277470048,-0.00244169120373945,-0.002437554821102002,-0.0024327525114903542,-0.0024279069740207036,-0.0024235414898570997,-0.0024201040424097005,-0.0024174434442760604,-0.0024153456778391036,-0.002413581209633001,-0.002411966694722241,-0.0024103540779060414,-0.002408570417586867,-0.0024065496723012633,-0.002404264550396247,-0.0024016863467212616,-0.002398816253557744,-0.0023956518270091256,-0.0023921970098953168,-0.0023884601403222905,-0.002384445482122002,-0.002380176725299027,-0.0023756480014537427,-0.002370838118044564,-0.002365724039930602,-0.0023603316902379313,-0.0023546638880878063,-0.00234869886540508,-0.0023424443351264426,-0.0023358774360060057,-0.002329005121019974,-0.0023218142619132577,-0.0023142923404423964,-0.002306471663893031,-0.0022983734553917137,-0.0022899777823319734,-0.0022812674935710022,-0.002272211807811285,-0.002262739850325043,-0.0022527570405538625,-0.002242096382664067,-0.0022305076305203717,-0.002217011548627371,-0.002200339562603717,-0.002179239704959262,-0.002152503525457389,-0.0021156430862922554,-0.0020793915723618184,-0.0020407198898077733,-0.001998861503792443,-0.0019530365811587396,-0.0019024747815000055,-0.0018465168501976181,-0.0017857691947829656,-0.0017211652082882668,-0.0016536314378629952,-0.0015841584062069739,-0.001517091518236637,-0.0014415308676589487,-0.0013603913786243522,-0.0012743826752266894,-0.0011842883199558237,-0.0010909416686011716,-0.0009951106012504843,-0.0008970446831402153,-0.0007969958526922822,-0.0006950950163765412,-0.0005914533412352672,-0.000486103182870024,-0.00037909977834311856,-0.0002705161009200587,-0.0001603695395478908,-4.8646776742380255e-05,6.459939798854004e-05,0.00017933227036369642,0.00029551950677555376,0.0004131649686634059,0.0005321821658847449,0.0006525377917909941,0.0007742170312736894,0.0008972431685910923,0.0010216358341551366,0.0011473918649787004,0.0012745392410344796,0.001403117211074791,0.0015331229755832449,0.001664523932231962,0.0017973077635652333,0.0019313674650751032,0.002066474697143155,0.0022022235740201566,0.002338041511244154,0.002473196051636838,0.002606759011928265,0.002737568352939062,0.002864328650725277,0.0029855790937157226,0.0030997514540944326,0.0032052050683179325,0.0033003692027065434,0.0033838771833435526,0.0034545973302851137,0.0035116832983052033,0.0035546050814140636,0.0035831969582672198,0.0035976537284052334,0.0035985081251176374,0.0035866160252172093,0.0035630800969526644,0.0035291638945539384,0.003486226419745232,0.0034355525443063944,0.0033783517305062153,0.003315732992346364,0.0032486762354356786,0.003177967421757404,0.003104250676881525,0.00302798406211065,0.002949475191806208,0.0028689426903161282,0.0027865211378340876,0.002702282544828239,0.002616287561787527,0.0025285665119671352,0.002439108249587402,0.0023479324691782115,0.0022550634945384,0.002160503348343738,0.002064304246540442,0.001966476226336697,0.001866979666653266,0.0017657678122066612,0.001662804190424991,0.0015580818749303905,0.0014516064906917843,0.0013433670860123182,0.0012333303052983475,0.001121521672944139,0.0010079576795285093,0.000892705899211376,0.00077596673931514,0.0006580497446132028,0.0005393992215993816,0.00042047174937439685,0.00030183004453194324,0.00018412412904651103,6.808251250681378e-05,-4.554386641217517e-05,-0.0001559890420700249,-0.0002553322148160008,-0.00033572931069416587,-0.0003965847670193583,-0.00043742877905810694,-0.00045795802068293926)
xcorr <- c(-102.0,-100.99507389162562,-99.99014778325123,-98.98522167487684,-97.98029556650246,-96.97536945812809,-95.9704433497537,-94.9655172413793,-93.96059113300493,-92.95566502463055,-91.95073891625616,-90.94581280788177,-89.94088669950739,-88.93596059113301,-87.93103448275862,-86.92610837438423,-85.92118226600985,-84.91625615763547,-83.91133004926108,-82.90640394088669,-81.90147783251231,-80.89655172413794,-79.89162561576354,-78.88669950738915,-77.88177339901478,-76.8768472906404,-75.87192118226601,-74.86699507389162,-73.86206896551724,-72.85714285714286,-71.85221674876847,-70.84729064039408,-69.8423645320197,-68.83743842364532,-67.83251231527093,-66.82758620689654,-65.82266009852216,-64.81773399014779,-63.812807881773395,-62.80788177339901,-61.802955665024626,-60.79802955665024,-59.79310344827586,-58.78817733990147,-57.78325123152709,-56.778325123152705,-55.77339901477832,-54.768472906403936,-53.76354679802955,-52.75862068965517,-51.75369458128078,-50.7487684729064,-49.743842364532014,-48.73891625615763,-47.733990147783246,-46.72906403940886,-45.72413793103448,-44.71921182266009,-43.71428571428571,-42.709359605911324,-41.70443349753694,-40.699507389162555,-39.69458128078817,-38.68965517241379,-37.6847290640394,-36.679802955665025,-35.67487684729063,-34.66995073891624,-33.665024630541865,-32.66009852216749,-31.655172413793096,-30.650246305418705,-29.645320197044327,-28.64039408866995,-27.63546798029556,-26.630541871921167,-25.62561576354679,-24.620689655172413,-23.61576354679802,-22.61083743842363,-21.605911330049253,-20.600985221674875,-19.596059113300484,-18.591133004926093,-17.586206896551715,-16.581280788177338,-15.576354679802947,-14.571428571428555,-13.566502463054178,-12.5615763546798,-11.55665024630541,-10.551724137931018,-9.54679802955664,-8.541871921182263,-7.536945812807872,-6.5320197044334805,-5.527093596059103,-4.522167487684726,-3.5172413793103345,-2.512315270935943,-1.5073891625615659,-0.5024630541871886,0.5024630541872028,1.5073891625615943,2.5123152709359715,3.5172413793103487,4.52216748768474,5.527093596059132,6.532019704433509,7.536945812807886,8.541871921182278,9.546798029556669,10.551724137931046,11.556650246305423,12.561576354679815,13.566502463054206,14.571428571428584,15.57635467980296,16.581280788177352,17.586206896551744,18.59113300492612,19.596059113300498,20.60098522167489,21.60591133004928,22.61083743842366,23.615763546798036,24.620689655172427,25.62561576354682,26.630541871921196,27.635467980295573,28.64039408866995,29.645320197044356,30.650246305418733,31.65517241379311,32.660098522167516,33.66502463054189,34.66995073891627,35.67487684729065,36.679802955665025,37.68472906403943,38.68965517241381,39.694581280788185,40.69950738916259,41.70443349753697,42.709359605911345,43.71428571428572,44.7192118226601,45.724137931034505,46.72906403940888,47.73399014778326,48.738916256157665,49.74384236453204,50.74876847290642,51.7536945812808,52.758620689655174,53.76354679802958,54.76847290640396,55.773399014778335,56.77832512315274,57.78325123152712,58.788177339901495,59.79310344827587,60.79802955665025,61.802955665024655,62.80788177339903,63.81280788177341,64.81773399014781,65.82266009852219,66.82758620689657,67.83251231527095,68.83743842364532,69.84236453201973,70.8472906403941,71.85221674876848,72.85714285714289,73.86206896551727,74.86699507389164,75.87192118226602,76.8768472906404,77.8817733990148,78.88669950738918,79.89162561576356,80.89655172413796,81.90147783251234,82.90640394088672,83.9113300492611,84.91625615763547,85.92118226600988,86.92610837438426,87.93103448275863,88.93596059113304,89.94088669950742,90.9458128078818,91.95073891625617,92.95566502463055,93.96059113300495,94.96551724137933,95.97044334975371,96.97536945812811,97.98029556650249,98.98522167487687,99.99014778325125,100.99507389162562,102.0)
altd  <- c(54)
x <- seq.int((length(p)-1)/2*-1,(length(p)-1)/2)
pdf('predictd_model.pdf',height=6,width=6)
plot(x,p,type='l',col=c('red'),main='Peak Model',xlab='Distance to the middle',ylab='Percentage')
lines(x,m,col=c('blue'))
legend('topleft',c('forward tags','reverse tags'),lty=c(1,1,1),col=c('red','blue'))
plot(xcorr,ycorr,type='l',col=c('black'),main='Cross-Correlation',xlab='Lag between + and - tags',ylab='Correlation')
abline(v=altd,lty=2,col=c('red'))
legend('topleft','alternative lag(s)',lty=2,col='red')
legend('right','alt lag(s) : 54',bty='n')
dev.off()
